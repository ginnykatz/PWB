<!doctype html>
<html lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CLEAN MARKUP = GOOD KARMA.
      Hi source code lover,

      you're a curious person and a fast learner ;)
      Let's make something beautiful together. Contribute on Github:
      https://github.com/webslides/webslides

      Thanks!
    -->

    <!-- SEO -->
    <title>Pure Water Brew</title>
    <meta name="description" content="Patty McCord wrote the document called 'Netflix Culture: Freedom & Responsibility'.It's one of the most important documents ever to come out of Silicon Valley.">

    <!-- URL CANONICAL -->
    <!-- <link rel="canonical" href="http://your-url.com/permalink"> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,700,700i%7CMaitree:200,300,400,600,700&amp;subset=latin-ext" rel="stylesheet">

    <!-- CSS Base -->
    <link rel="stylesheet" type='text/css' media='all' href="css/webslides.css">

    <!-- Optional - CSS SVG Icons (Font Awesome) -->
    <link rel="stylesheet" type="text/css" media="all" href="css/svg-icons.css">


    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.css">


    <!-- Mapbox GL -->
    <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.35.1/mapbox-gl.css" rel='stylesheet' />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">


    <link rel="stylesheet" type="text/css" media="all" href="css/style.css">

    <!-- SOCIAL CARDS (ADD YOUR INFO) -->

    <!-- FACEBOOK -->
    <!-- EDIT -->
    <meta property="og:url" content="http://your-url.com/permalink">

    <!-- EDIT -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="WebSlides: Netflix's Culture" />
    <meta property="og:description" content="Patty McCord created Netflix's culture. This is a homage.">

    <!-- EDIT -->
    <meta property="og:updated_time" content="2017-04-16T16:24:56">
    <!-- EDIT -->
    <meta property="og:image" content="../static/images/share-webslides.jpg" >
    <!-- EDIT -->
    <meta property="og:image:width" content="800">
    <meta property="og:image:height" content="429">

    <!-- TWITTER -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@CleanWaterNews">

    <!-- EDIT -->
    <meta name="twitter:creator" content="@CleanWaterNews">
    <!-- EDIT -->
    <meta name="twitter:title" content="Clean Water Services News">
    <!-- EDIT -->
    <meta name="twitter:description" content="Water resources management utility for 570,000 residents in the Tualatin River Watershed.">
    <!-- EDIT -->
    <meta name="twitter:image" content="">

    <!-- EDIT -->

    <!-- FAVICONS -->
    <link rel="shortcut icon" href="img/favicon2.png">
    <link rel="apple-touch-icon icon" sizes="192x192" href="img/favicon2.png">

    <!-- Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#333333">
    <script src="js/starfield.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.js"></script>


    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.35.1/mapbox-gl.js"></script>

    <script src="https://rawgit.com/mapbox/mapbox-gl-leaflet/master/leaflet-mapbox-gl.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

    <script src="http://d3js.org/d3.v5.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="http://d3js.org/topojson.v0.min.js"></script>



    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->
    <!--<script src="https://d3js.org/d3.v5.min.js"></script>-->
    <script src="https://dc-js.github.io/dc.js/js/crossfilter.js"></script>
    <script src="https://dc-js.github.io/dc.js/js/dc.js"></script>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>





    <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
    <!--<script src="https://rawgit.com/Asymmetrik/leaflet-d3/master/dist/leaflet-d3.js"></script>-->
    <script src="js/leaflet-d3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>
    <!--<script src="js/tweets.js"></script>-->

    <script src="//unpkg.com/three"></script>
    <script src="//unpkg.com/three-spritetext"></script>

    <script src="//unpkg.com/3d-force-graph"></script>


    <!--<script src="js/versor.js"></script>-->
</head>

<body>
<header role="banner">
    <nav role="navigation">

        <p class="logo"><a href="index.html" title="Clean Water Services"><img href="img/favicon2.png" />Pure Water Brew</a></p>
        <ul>
            <li class="github">
                <a rel="external" href="https://github.com/jakobzhao" title="Github">
                    <svg class="fa-github">
                        <use xlink:href="#fa-github"></use>
                    </svg>
                    <em>Github</em>
                </a>
            </li>
            <li class="twitter">
                <a rel="external" href="https://twitter.com/cleanwaternews?lang=en" title="Twitter">
                    <svg class="fa-twitter">
                        <use xlink:href="#fa-twitter"></use>
                    </svg>
                    <em>@WebSlides</em>
                </a>
            </li>
            <!--  <li class="dribbble"><a rel="external" href="http://dribbble.com/webslides" title="Dribbble"><svg class="fa-dribbble"><use xlink:href="#fa-dribbble"></use></svg> <em>webslides</em></a></li> -->
        </ul>
    </nav>
</header>

<main role="main">
    <article id="webslides">

        <section class="bg-apple">


            <!--<span class="background" style="background-image:url('https://source.unsplash.com/E695OZJiju4/1600x800')"></span>-->
            <!--.wrap = container width: 90% -->
            <!--<div class="wrap">-->
            <!--<p class="text-subtitle">Powered by <a href="https://webslides.tv">WebSlides</a>.</p>-->
            <!--<h1>-->
            <!--<strong>Designing Interviews</strong>-->
            <!--</h1>-->
            <!--<p>All content is for demo purposes only.</p>-->
            <!--<p><img class="avatar-40" src="../static/images/avatar.jpg" alt="Avatar David Yang"> By David Yang. Nov 8th, 2024.</p>-->
            <!--</div>-->
            <!---->

            <!--Landing-->
            <video class="background-video dark" autoplay muted loop>
                <source src="assets/storyline/act1/landing/background.mp4" type="video/mp4">
            </video>
            <div class="wrap aligncenter">
                <h1>
                    <strong>Changing the coneversation with the Pure Water Brew challenge
                        to create mindset shift</strong>
                </h1>
                <p class="text-symbols">* * * </p>

                <!--slide-bottom-->
                <!--<div class="wrap aligncenter">-->
                <p><a href="https://twitter.com/cleanwaternews?lang=en" title="Diane Taniguchi-Dennis, Clean Water Services"><img class="avatar-64 img-thumbnail" src="img/taniguchi-dennis.jpg" alt="Diane Taniguchi-Dennis, Clean Water Services"></a> By Diane Taniguchi-Dennis · Deputy General Manager · Clean Water Services </p>
                <p>July 9th, 2018 · Singapore</p>
            </div>

        </section>



        <!--intro-->
        <section class="bg-apple">
            <!--<span class="background dark" style="background-image:url('assets/storyline/act1/landing/background.mp4')"></span>-->
            <!--.wrap = container (width: 90%) -->
            <div class="wrap">

                <div id="mymap"></div>
                <
            </div>
            <!-- .end .wrap -->
        </section>


        <!--conversation-->
        <section class="bg-apple">
            <!--.wrap = container (width: 90%) -->
            <div class="wrap">
                <blockquote class="align-left text-quote">
                    <p>When you said <span class="neg-term">Pee Pee</span>  Pilsner, I immediately went to <span class="neg-term">Poo Poo </span>Porter.</p>
                </blockquote>
                <p class="content-right"><cite class="date"><img class="whitelogo" style="height: 35px" src="assets/storyline/act1/conversation/basic-white-logo.png" /><a href="http://www.basicbrewing.com/index.php?page=basic-brewing-radio-2015"></a> May 14,2015 </cite></p>
                <blockquote class="align-left text-quote">
                    <p>Mmm, nothing like sitting back and cracking open a cold can of crisp amber ale...that was once <span class="neg-term">sewage</span>.</p>
                </blockquote>
                <p class="content-right"><cite class="date"><img class="whitelogo" style="height: 40px" src="img/business-insider.png" /><a href="http://www.businessinsider.com/we-tried-beer-brewed-from-sewage-and-it-tasted-surprisingly-good-2015-9"></a> Oct. 23, 2015 </cite></p>
                <blockquote class=" align-left text-quote">
                    <p>Water so clean it exceeds drinking water standards. Water so pure even healthy minerals are stripped away. Water recycled from the <span class="neg-term">sewer</span>.</p>
                </blockquote>
                <p class="content-right"><cite class="date"><img class="whitelogo" style="height: 40px" src="assets/storyline/act1/conversation/citylab-logo.png" /><a href="https://www.citylab.com/life/2015/02/oregon-homebrewers-get-set-to-experiment-with-sewerage-brewerage/385610/"></a> Feb. 19, 2015 </cite></p>


            </div>
            <!-- .end .wrap -->
        </section>

        <!--pure-->
        <section class="fullscreen bg-apple">
            <div class="card-60">
                <figure>
                    <img src="img/pwb-cans.jpg" alt="Pure">
                </figure>
                <!-- end figure-->
                <div class="flex-content content-center">
                    <p>    <img class="size-30" src="assets/img/pwb-quality-logo.svg"></p>
                </div>
                <!-- end .flex-content-->
            </div>
            <!-- end .card-50-->
        </section>

        <!--test-->


        <!--<section class="bg-apple">-->

            <!--<video class="background-video dark" autoplay muted loop>-->
                <!--<source src="assets/filter.mp4" type="video/mp4">-->
            <!--</video>-->

            <!--<div class="wrap">-->
                <!--<div class="alignright size-30 bg-trans-light">-->
                    <!--<p class="aligncenter">The Initial testing Site @ Cook Park, near Hillsboro, Oregon in Oct. 2015</p>-->
                    <!--<img class="aligncenter" src="assets/storyline/act1/test/or-map-red-star.png">-->

                <!--</div>-->
            <!--</div>-->
            <!--&lt;!&ndash; .end .wrap &ndash;&gt;-->
        <!--</section>-->



        <section class="bg-apple slide-top">
            <video class="background-video dark" autoplay muted loop>
                <source src="assets/filter.mp4" type="video/mp4">
            </video>

            <div class="wrap">
                <div class="alignright size-30 bg-trans-light">
                    <!--<h4 class="aligncenter"></h4>-->
                    <img class="aligncenter" src="assets/storyline/act1/test/or-map-red-star.png">
                    <p class="aligncenter"><small> The Initial testing Site @ Cook Park, near Hillsboro, Oregon in Oct. 2015</small></p>
                </div>
            </div>
            <!-- .end .wrap -->
        </section>







        <!--<section class="bg-apple">-->
            <!--<video class="background-video dark" autoplay muted loop>-->
                <!--<source src="assets/filter.mp4" type="video/mp4">-->
            <!--</video>-->

            <!--<div class="wrap">-->
                <!--<div class="grid">-->
                    <!--<div class="colum">-->
                        <!--&lt;!&ndash;<p class="text-intro content-center">Initiating Research</p>&ndash;&gt;-->
                        <!--<p class="content-center"><img style="width:350px" src="assets/storyline/act1/test/or-map-red-star.png"></p>-->
                        <!--<p><span class="fas fa-star" style="color:red"></span> &nbsp; highlights the Initial testing, which was conducted at Cook Park, near Hillsboro, Oregon in Oct. 2015. </p>-->
                    <!--</div>-->
                    <!--<div class="column">-->
                        <!--<div>-->
                            <!--<div class="embed">-->
                                <!--<video autoplay loop muted poster="">-->
                                    <!--<source src="assets/filter.mp4" type="video/mp4">-->
                                <!--</video>-->
                            <!--</div>-->
                            <!--&lt;!&ndash; normalize flexbox &ndash;&gt;-->
                        <!--</div>-->
                        <!--&lt;!&ndash; end .embed &ndash;&gt;-->
                    <!--</div>-->
                    <!--&lt;!&ndash; end .column &ndash;&gt;-->
                <!--</div>-->
                <!--&lt;!&ndash; end .grid &ndash;&gt;-->
            <!--</div>-->
            <!--&lt;!&ndash; .end .wrap &ndash;&gt;-->
        <!--</section>-->


        <!--Filtration-->

        <section class="bg-apple">
            <div class="wrap aligncenter">
                <h2>Filtration</h2>
                <p></p>

                <ul class="flexblock features">
                    <!-- li>a? Add blink = <ul class="flexblock steps blink">-->
                    <li>
                        <div class="process step-1"></div>
                        <span>
                  <img src="assets/storyline/act2/filtration/tap.png"/>
                </span>
                        <h2>Infrastructure</h2>
                        <p>Physical base of our purification process</p>
                    </li>
                    <li>
                        <div class="process step-2"></div>
                        <span>
                            <!--<div>Icon made by <a href="http://www.freepik.com" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div> -->
                            <img src="assets/storyline/act2/filtration/manometer.png" />
                </span>
                        <h2>Sensors & Controls</h2>
                        <p>Flow and quality monitoring</p>
                    </li>
                    <li>
                        <div class="process step-3"></div>
                        <span>
                  <i class="fas fa-comments">
                  </i>
                </span>

                        <h2>Communication</h2>
                        <p>Transmitting real-time data</p>
                    </li>
                <li>
                        <div class="process step-4"></div>
                        <span>
                 <img src="assets/storyline/act2/filtration/data-vis.png"/>
                </span>

                        <h2>Data Visualization</h2>
                        <p>Software that visualizes our water data</p>
                        <!--<div>Icons made by <a href="http://www.freepik.com" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>-->
                    </li>
                    <li>
                        <div class="process step-5"></div>
                        <span>
                  <i class="fab fa-wikipedia-w">
                  </i>
                </span>
                        <h2>Wiki</h2>
                        <p>Objective dashboard for public review and education</p>
                    </li>
            </ul>

            </div>
        </section>
        <!--Engaged brewqers-->
        <section class="fullscreen slide-top bg-apple">
            <!--<div class="card-70">-->
                <!--<figure>-->
                    <div id="network"></div>
                <!--</figure>-->
                <!-- end figure-->
                <div class="flex-content">
                    <h2>Engaged Brewers
                    </h2>
                    <p class="text-intro">Local partnership makes it possible.</p>
                </div>
                <!-- end .flex-content-->
            <!--</div>-->
            <!-- end .card-50-->
            <!-- .end .wrap -->
        </section>

        <!--<section class="fullscreen bg-apple">-->
            <!--<div class="card-70">-->
                <!--<figure>-->
                    <!--<img id="logo" src="assets/storyline/act3/brewers/logo-web.png" alt="brewer relationships">-->
                <!--</figure>-->
                <!--&lt;!&ndash; end figure&ndash;&gt;-->
                <!--<div class="flex-content">-->
                    <!--<h2>Engaged Brewers-->
                    <!--</h2>-->
                    <!--<p class="text-intro">Local partnership makes it possible.</p>-->
                <!--</div>-->
                <!--&lt;!&ndash; end .flex-content&ndash;&gt;-->
            <!--</div>-->
            <!-- end .card-50-->
            <!-- .end .wrap -->
        </section>
        <section class="fullscreen bg-apple">
            <div class="card-60">
                <figure>
                    <img src="assets/storyline/act2/sustainability/box-sample.jpg" alt="press kit sample">
                </figure>
                <!-- end figure-->
                <div class="flex-content aligncenter">
                    <h2>
                        <!--<i class="far fa-envelope"></i> -->
                        An Invitation </h2>
                    <p class="text-symbols">* * * </p>
                    <p>The Pure Water Brew Sustainability Challenge</p>
                    <p class="text-intro">The start of the broader conversation we all need to have about the nature of water.  </p>
                </div>
                <!-- end .flex-content-->
            </div>
            <!-- end .card-50-->

        </section>


        <section class="bg-apple">
            <div class="wrap">


                <div class="grid vertical-align">
                    <div class="column">
                        <ul class="flexblock specs">
                            <li>
                                <div>
                                    <h2>Department of Environmetnal Quality, Oregon</h2>
                                    <p><img class="img-thumbnail" src="img/deq-logo-3.png"> "Using recycled water will become increasingly important in our region as demands on our water resources increase."</p>
                                </div>
                            </li>
                            <li>
                                <h2>Environment Protection Agency, U.S.A</h2>
                                <p> <img class="img-thumbnail" src="assets/storyline/act2/breakthrough/epa-seal.png"/>"Pure Water Brew is an excellent example of our ability to take water that is otherwise thought of as waste and put it to direct positive value- as a beer."</p>
                            </li>
                        </ul>
                    </div>
                    <div class="column">
                        <figure>
                            <div class="embed">
                                <video autoplay loop muted poster="">
                                    <source src="assets/storyline/act2/breakthrough/epa-interview2.mp4" type="video/mp4">
                                </video>
                            </div>
                        </figure>
                    </div>
                </div>


                <!-- .end card-50 -->
            </div>
            <!-- .end .wrap -->
        </section>


        <section class="bg-apple">
            <!--<span class="background dark" style="background-image:url('assets/storyline/act1/landing/background.mp4')"></span>-->
            <!--.wrap = container (width: 90%) -->

            <div id="worduniverse"></div>

            <!-- .end .wrap -->
        </section>


        <!--<section class="bg-apple">-->
            <!--&lt;!&ndash;<span class="background dark" style="background-image:url('assets/storyline/act1/landing/background.mp4')"></span>&ndash;&gt;-->
            <!--&lt;!&ndash;.wrap = container (width: 90%) &ndash;&gt;-->
            <!--<div class="wrap">-->

                <!--<div id="mymap2"></div>-->
                <!--<-->
            <!--</div>-->
            <!--&lt;!&ndash; .end .wrap &ndash;&gt;-->
        <!--</section>-->


        <section class="bg-apple slide-top">

                <div id="mymap2"></div>

            <div id="date-chart"></div><p>the placeholder for charts</p>

            <!-- .end .wrap -->
        </section>


        <!--Bill-->
        <section class="bg-apple">
            <span class="background-left-bottom" style="background-image:url('img/bill-2.png')"></span>
            <div class="wrap">
                <div class="content-right">
                    <blockquote class="text-quote">
                        <p>The only thing <strong><i>remarkable</i></strong> about it is that it isn't <strong><i>remarkable</i></strong> at all.</p>
                        <cite>Bill Gaffi, P.E., General Manager of Clean Water Services</cite>
                    </blockquote>
                </div>
            </div>
            <!-- .end .wrap -->
        </section>
        <!--Beer Happy (need better images of laughing/talking in a pub with beer.-->
        <section class="bg-apple">
            <span class="background" style="background-image:url('img/beerworks.jpg')"></span>
            <!--.wrap = container (width: 90%) -->
            <div class="wrap aligncenter fadeInUp">
                <h2><strong>Everyone <i class="fas fa-heart"></i> beer!</strong></h2>
            </div>
            <!-- .end .wrap -->
        </section>

        <!--lotus-->
        <section class="bg-apple">
            <span class="background-left-bottom" style="background-image:url('img/lotus.png')"></span>
            <div class="wrap">
                <div class="content-center">
                    <!--https://d3wynightunr0lls.wordpress.com/2016/03/02/%E7%88%B1%E8%8E%B2%E8%AF%B4%EF%BC%9Aon-the-love-of-the-lotus-by-%E5%91%A8%E6%95%A6%E9%A2%90-zhou-dun-yi/-->
                    <!--《愛蓮說》———— 周敦頤-->
                    <!--出淤泥而汙染，濯清漣而不妖 (-->
                    <!--On the love of Lotus-->
                    <blockquote class="text-quote">
                        <p > I only love the lotus, which came out of mud yet is not contaminated, Washed by ripples yet is not voluptuous.</p>
                    </blockquote>
                    <cite> <img class="img-thumbnail avatar-64" src="img/dunyi.jpg"> Dunyi Zhou (1017 -1073 A.D.) </cite>
                </div>
            </div>
            <!-- .end .wrap -->
        </section>


        <section class="bg-apple slide-bottom">

            <video class="background-video dark" autoplay muted loop>
                <source src="assets/storyline/act3/closing/background-nature.mp4" type="video/mp4">
            </video>

            <div class="wrap alignright fadeInUp">
                <div class="content-right text-serif">
                    <h2>
                        <strong>Thanks ·謝謝 · Terima Kasih · धन्यवाद </strong>
                        <a target="_blank" title="Share on Twitter" href="https://twitter.com/intent/tweet?text=share%20the%20story%20from%20CWS"><i class="fab fa-twitter"></i></a>

                        <small><a href="https://twitter.com/CleanWaterNews">@CleanWaterNews</a></small>
                    </h2>

                    <p> <a href="https://twitter.com/cleanwaternews?lang=en" title="Diane Taniguchi-Dennis, Clean Water Services"><img class="avatar-40 img-thumbnail" src="img/taniguchi-dennis.jpg" alt="Diane Taniguchi-Dennis, Clean Water Services"></a> By Diane Taniguchi-Dennis
                    </p>
                    <p>July 9th, 2018 · Singapore</p>
                </div>
                <!-- .end .content-right -->
            </div>

            <!-- .end .wrap -->
        </section>





    </article>
</main>
<!--main-->

<footer>
    <div class="wrap">
        <p>
            <span class="alignright "><a href="https://www.cleanwaterservices.org/" title="Clean Water Service"><img class="whitelogo" src="img/logo-cws-white.png" alt="Clean Water Service"></a></span>

            <!--<span class="alignleft"><a href="https://github.com/jakobzhao" title="Zhao, Katz, Van Stolk, Farmer"><img src="" alt="OSU"></a></span>-->
        </p>

        <!--<p><span class="alignleft"><a href="https://www.cleanwaterservices.org/" title="Clean Water Service"><img class="img.blacklogo" src="img/siww-logo.png" alt="Clean Water Service"></a></span></p>-->
    </div>
</footer>

<!-- Required -->
<script src="js/webslides.js"></script>


<script>

    var map = L.map("mymap", {zoomControl: false, scrollWheelZoom: false}).setView([44, -120], 3);
    var map2 = L.map("mymap2", {zoomControl: false, scrollWheelZoom: false}).setView([44, -120], 3);



    L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoiemhhb2JvIiwiYSI6ImNqMGdpM2RjNDAyMzQzMnJ1d3FuZmF0NnQifQ.yoQP0NDS5F8ePKjaS3EJgQ', {
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map);



    CartoDB_PositronNoLabels2 = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map2);


    colorscheme = chroma.scale(["green", "red"]).mode("lab").colors(5);


    // var options = {
    //     opacity: 0.9,
    //     radiusRange: [ 1, 30 ],
    //     duration: 200,
    //     colorScaleExtent: [ 1, undefined ],
    //     colorRange: colorscheme,
    //     pointerEvents: 'auto'
    // };

    // var hexLayer = L.hexbinLayer(options).addTo(map2);


    // $.getJSON("assets/cell_towers.geojson", function( data ) {


    // var tweets2 = [];
    // for(var i = 0; i < tweets.features.length; i++) {
    //    lng = tweets.features[i].geometry.coordinates[1];
    //    lat = tweets.features[i].geometry.coordinates[0];
    //    tweets2.push([lat, lng]);
    // }
    // hexLayer.data(tweets2);

    // });



    // L.geoJson.ajax("assets/cell_towers.geojson").addTo(map2);


    ws = new WebSlides();



    var greenIcon = L.icon({
        iconUrl: 'img/logo-cws.png',
        iconSize:     [318, 76], // size of the icon
        shadowSize:   [0, 64], // size of the shadow
        iconAnchor:   [80, 25]// point from which the popup should open relative to the iconAnchor
    });



    L.marker([45.514685, -122.987080], {icon: greenIcon}).addTo(map);


    $(".leaflet-marker-icon").addClass("flashit");





    ws.el.addEventListener('ws:slide-change', function() {


        if ($(".current").has("[class*='leaflet']").length) {
            map.invalidateSize();
            map.setView([45.514685, -122.987080], 4);
            // map.flyTo([45.514685, -122.987080], 9, {animate: true, duration: 15});

        }

        if ($(".current div").attr("id") === "worduniverse") {
            $("#worduniverse")
                .empty()
                .append('<canvas id="canvas2d"></canvas>');
            new StarField('worduniverse').render(100, 3);
        }







        if ($(".current div").attr("id") === "mymap2") {
            map2.invalidateSize();


        // var tweets2 = [];
        // for(var i = 0; i < tweets.features.length; i++) {
        //     lng = tweets.features[i].geometry.coordinates[1];
        //     lat = tweets.features[i].geometry.coordinates[0];
        //     tweets2.push([lat, lng]);
        // }
        // hexLayer.data(tweets2);


        //add in the .csv file .then() run the functions on that data
        d3.json('assets/data/media-locs.geojson').then(function (data) {




            //the .dimensions() method
            var filter = crossfilter(data.features); //passes the features to the crossfilter

            // groups everything together into one group, this is used to quickly search all of the data at once
            var all = filter.groupAll();


            //Takes each of the records of the dataset and returns each individual line so that they can be used. .dimension() puts
            // the data into an easily searchable/manipulable format for DC
            var everything = filter.dimension(function (d) {
                return d
            });

            //////////////////////////////////////////////SORT THE DATA///////////////////////////////////////////////////////////
            //Now that we have our initial data imported and in the right format using crossfilter we now have to sort out the data that we want to display, set up
            //the chart space and populate the graphs

            //returns the geometry for each feature; this is the points at which each earthquake happened
            var geomDimension = filter.dimension(function (d) {
                return d.geometry
            });


            var dateDimension = filter.dimension(function (d) {
                // alert(d.properties.time)
                var e = d.properties.time.split("/");
                month = +e[0];
                day = +e[1];
                year = +e[2];
                return d3.timeDay(new Date(year, month, day));
            });

            /////////////////////////////////////////GROUP THE DATA///////////////////////////////////////////////////////////////
            // Now that we have the mag dimension captured in an object we have to group them all together so that we can use them


            //////////////////////////////////////////////////PREP THE DATA////////////////////////////////////////////////////////
            //create crossfilter passes each feature to the filter. We have to pass it through the crossfilter before we can split up with data using


            var dateDimensionGroup = dateDimension.group(); //

            ///////////////////////////////////////////////ADD THE MARKERS TO THE MAP///////////////////////////////////////////////
            var geoJsonLayer = L.geoJson({
                type: 'FeatureCollection',
                features: geomDimension.top(Infinity) //starts selecting from the .top() and goes until...infinity
            }, {
                pointToLayer: function (feature, latlng) {
                    return L.circleMarker(latlng, {
                        // radius: Math.pow(feature.properties.mag, 2) / 2,
                        radius: 4,
                        fillColor: "steelblue",
                        color: "#fff",
                        weight: 1,
                        stroke: false,
                        opacity: 0.5,
                        fillOpacity: 0.5
                    })
                }
            }).addTo(map2);

            /////////////////////////////////////CREATE THE CHARTS////////////////////////////////////////////////////////////////
            //binds the barChart  to the <div> elements that we created earlier in the <body>

            var dateChart = dc.lineChart('#date-chart');
            dateChart
                .renderArea(true) //area or lines
                .height(150)
                .transitionDuration(1000) //how long it takes to transition
                .margins({
                    top: 10,
                    right: 10,
                    bottom: 15,
                    left: 10
                })
                .dimension(dateDimension)
                .group(dateDimensionGroup)
                .elasticY(true)
                .x(d3.scaleTime().domain([new Date(2015, 1, 20), new Date(2015, 11, 1)])) //
                .xUnits(d3.timeDays)
                .xAxis()
                .ticks(8);

            /////////////////////////////////////////DRAW ALL THE CHARTS//////////////////////////////////////////////////////////
            dc.renderAll(); //activates everything
            //we can render things one at a time but it is more efficent (and easier) to render everything at the end


            ////////////////////////////////////////LISTEN FOR CHANGES ON THE MAP//////////////////////////////////////////////////

            //define in functions what we want to have happen to the map
            //This function sees which features are in the bounding box and returns the points that are in it; This filters the
            //data for the charts and map.
            function updateCharts() {
                geomDimension.filter(function (d) {
                    return map2.getBounds().contains(L.geoJSON(d).getBounds())
                });
                dc.redrawAll();
            }

            function updateMap() {
                geoJsonLayer.clearLayers(); //removes everything
                geoJsonLayer.addData({ //adds the new data to the map/chart within the scope of the filter
                    type: 'FeatureCollection',
                    features: everything.top(Infinity)
                });
            }


            //selects the map and runs a filter function on it once it's done moving and zooming
            map2.on('zoomend moveend', function () { //passes the zoom and move locations as the new filter
                updateCharts(); //triggers the new function
            });


            dateChart.on('filtered', function (chart, filter) {
                updateMap()
            });

        })


    }







        if ($(".current div").attr("id") === "network") {
            $("#network")
                .empty()


            const Graph = ForceGraph3D()
            (document.getElementById('network'))
                .jsonUrl('assets/data/miserables.json')
                .nodeAutoColorBy('group')
                .nodeThreeObject(node => {
                    const sprite = new SpriteText(node.name);
                    sprite.color = node.color;
                    sprite.textHeight = 8;
                    return sprite;
                });


            // Spread nodes a little wider
            Graph.d3Force('charge').strength(-550);

        }









    });




    //
    //
    // var width = 960,
    //     height = 500;
    // var proj = d3.geoOrthographic()
    //     .scale(230)
    //     .translate([width / 2, height / 2])
    //     // change this to 180 for transparent globe
    //     .clipAngle(90);
    // var path = d3.geoPath().projection(proj).pointRadius(1.5);
    // var graticule = d3.geoGraticule();
    //
    // var london = [-0.118667702475932, 51.5019405883275];
    //
    // var time = Date.now();
    // var rotate = [39.666666666666664, -30];
    // var velocity = [.015, -0];
    //
    // var lineToLondon = function(d) {
    //     return path({"type": "LineString", "coordinates": [london, d.geometry.coordinates]});
    // }
    // function stripWhitespace(str) {
    //     return str.replace(" ", "");
    // }
    // var svg = d3.select("#location").append("svg")
    //     .attr("width", width)
    //     .attr("height", height);
    // // .attr("viewBox", "0 0 100% 100%");
    // svg.call(d3.drag()
    //     .on("start", dragstarted)
    //     .on("drag", dragged));
    // queue()
    //     .defer(d3.json, "assets/world-110m.json")
    //     .defer(d3.json, "assets/places.json")
    //     .await(ready);
    // function ready(error, world, places) {
    //     svg.append("circle")
    //         .attr("cx", width / 2)
    //         .attr("cy", height / 2)
    //         .attr("r", proj.scale())
    //         .attr("class", "noclicks")
    //         .attr("fill", "none");
    //
    //     svg.append("path")
    //         .datum(topojson.object(world, world.objects.land))
    //         .attr("class", "land")
    //         .attr("d", path);
    //     svg.append("path")
    //         .datum(graticule)
    //         .attr("class", "graticule noclicks")
    //         .attr("d", path);
    //     svg.append("g").attr("class","points")
    //         .selectAll("text").data(places.features)
    //         .enter().append("path")
    //         .attr("class", "point")
    //         .attr("d", path);
    //
    //     svg.append("g").attr("class","lines")
    //         .selectAll(".lines").data(places.features)
    //         .enter().append("path")
    //         .attr("class", "lines")
    //         .attr("id", d => stripWhitespace(d.properties.name))
    //         .attr("d", d => lineToLondon(d));
    //     svg.append("g").attr("class","labels")
    //         .selectAll("text").data(places.features)
    //         .enter().append("text")
    //         .attr("class", "label")
    //         .text(d => d.properties.name)
    //         .on("mouseover", (d) => {
    //             var distance = Math.round(d3.geoDistance(d.geometry.coordinates, london) * 6371);
    //             d3.select("g.info").select("text.distance").text("Distance from London: ~" + distance + "km");
    //             var name = stripWhitespace(d.properties.name);
    //             d3.select("g.lines").select("#" + name).style("stroke-opacity", 1)
    //         })
    //         .on("mouseout", (d) => {
    //             var name = stripWhitespace(d.properties.name);
    //             d3.select("g.lines").select("#" + name).style("stroke-opacity", 0.3)
    //             d3.select("g.info").select("text.distance").text("Distance from London: Hover Over A Location");
    //         });
    //
    //     svg.append("g").attr("class","countries")
    //         .selectAll("path")
    //         .data(topojson.object(world, world.objects.countries).geometries)
    //         .enter().append("path")
    //         .attr("d", path);
    //     position_labels();
    //
    //     svg.append("g").attr("class", "info")
    //         .append("text")
    //         .attr("class", "distance")
    //         .attr("x", width / 20)
    //         .attr("y", height * 0.9)
    //         .attr("text-anchor", "start")
    //         .style("font-size", "12px")
    //         .text("Distance from London: Hover Over A Location");
    //
    //     refresh();
    //
    //     spin();
    // }
    // function position_labels() {
    //     var centerPos = proj.invert([width/2,height/2]);
    //     svg.selectAll(".label")
    //         .attr("text-anchor", (d) => {
    //             var x = proj(d.geometry.coordinates)[0];
    //             return x < width/2-20 ? "end" :
    //                 x < width/2+20 ? "middle" :
    //                     "start"
    //         })
    //         .attr("transform", (d) => {
    //             var loc = proj(d.geometry.coordinates),
    //                 x = loc[0],
    //                 y = loc[1];
    //             var offset = x < width/2 ? -5 : 5;
    //             return "translate(" + (x+offset) + "," + (y-2) + ")"
    //         })
    //         .style("display", (d) => {
    //             var d = d3.geoDistance(d.geometry.coordinates, centerPos);
    //             return (d > 1.57) ? 'none' : 'inline';
    //         })
    //
    // }
    // function refresh() {
    //     svg.selectAll(".land").attr("d", path);
    //     svg.selectAll(".countries path").attr("d", path);
    //     svg.selectAll(".graticule").attr("d", path);
    //     svg.selectAll(".point").attr("d", path);
    //     svg.selectAll(".lines").attr("d", (d) => { if (d) { return lineToLondon(d); }});
    //     position_labels();
    // }
    //
    // var timer;
    //
    // function spin() {
    //     timer = d3.timer(function() {
    //         var dt = Date.now() -time;
    //
    //         proj.rotate([rotate[0] + velocity[0] * dt, rotate[1] + velocity[1] * dt]);
    //
    //         refresh();
    //     });
    // }
    //
    // function dragstarted() {
    //     timer.stop();
    //     v0 = versor.cartesian(proj.invert(d3.mouse(this)));
    //     r0 = proj.rotate();
    //     q0 = versor(r0);
    // }
    //
    // function dragged() {
    //     var v1 = versor.cartesian(proj.rotate(r0).invert(d3.mouse(this))),
    //         q1 = versor.multiply(q0, versor.delta(v0, v1)),
    //         r1 = versor.rotation(q1);
    //     proj.rotate(r1);
    //     refresh();
    // }




</script> <!-- Autoslide? window.ws = new WebSlides({ autoslide: 8000 }); -->

<!-- OPTIONAL - svg-icons.js (fontastic.me - Font Awesome as svg icons) -->
<script defer src="js/svg-icons.js"></script>

</body>
</html>
